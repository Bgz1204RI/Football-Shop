{% extends "main.html" %} 
{% block title %}Football Shop — Products{% endblock %}
{% block content %}
<div class="mx-auto mt-8 w-full max-w-5xl px-4">
  <!-- Header / actions -->
  <div class="mb-6 flex flex-col items-start justify-between gap-3 sm:flex-row sm:items-center">
    <div>
      <h1 class="text-2xl font-bold text-gray-900">Football Shop — Products</h1>
      <p class="mt-1 text-sm text-gray-600">
        Welcome, {{ user.username }} · Last login: {{ last_login }}
      </p>
    </div>
    <div class="flex items-center gap-2">
      <a href="{% url 'main:show_xml' %}"
         class="rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50">
        XML (all)
      </a>
      <a href="{% url 'main:show_json' %}"
         class="rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50">
        JSON (all)
      </a>

      <!-- AJAX toolbar -->
      <button id="btn-open-create"
              class="rounded-lg bg-emerald-600 px-3 py-2 text-sm font-semibold text-white hover:bg-emerald-700">
        ➕ Add Product
      </button>
      <button id="btn-refresh"
              class="rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50">
        Refresh
      </button>

      <!-- (optional) keep server logout if you want -->
      <a href="{% url 'main:logout' %}"
         class="rounded-lg border border-red-200 bg-white px-3 py-2 text-sm font-medium text-red-700 hover:bg-red-50">
        Logout
      </a>
    </div>
  </div>

  <!-- Async states -->
  <div id="state-loading" class="mb-3 hidden text-gray-600">Loading…</div>
  <div id="state-error" class="mb-3 hidden text-rose-700"></div>
  <div id="state-empty" class="mb-3 hidden text-gray-500">No products yet.</div>

  <!-- AJAX-rendered list -->
  <ul id="product-list" class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3"></ul>
</div>

<!-- Create/Update modal -->
<dialog id="modal-form" class="rounded-xl p-0 shadow-xl">
  <form id="product-form" method="dialog" class="p-4 w-[92vw] max-w-xl">
    <h3 id="modal-title" class="text-lg font-semibold mb-3">Create Product</h3>
    <input type="hidden" id="field-id">

    <div class="grid gap-3">
      <label class="block text-sm">Name <input id="field-name" class="w-full rounded border p-2" required></label>
      <label class="block text-sm">Price <input id="field-price" type="number" class="w-full rounded border p-2" required></label>
      <label class="block text-sm">Category <input id="field-category" class="w-full rounded border p-2"></label>
      <label class="block text-sm">Size
        <select id="field-size" class="w-full rounded border p-2">
          <option>S</option><option selected>M</option><option>L</option><option>XL</option>
        </select>
      </label>
      <label class="block text-sm">Stock <input id="field-stock" type="number" class="w-full rounded border p-2" value="0"></label>
      <label class="block text-sm">Thumbnail URL <input id="field-thumb" class="w-full rounded border p-2"></label>
      <label class="block text-sm">Description <textarea id="field-desc" class="w-full rounded border p-2"></textarea></label>

      <div class="flex items-center gap-4">
        <label class="inline-flex items-center gap-2"><input id="field-featured" type="checkbox"> Featured</label>
        <label class="inline-flex items-center gap-2"><input id="field-sale" type="checkbox"> For Sale</label>
      </div>
    </div>

    <div class="mt-4 flex justify-end gap-2">
      <button value="cancel" class="rounded border px-3 py-2">Cancel</button>
      <button id="btn-save" value="default" class="rounded bg-emerald-600 text-white px-3 py-2">Save</button>
    </div>
  </form>
</dialog>

<!-- Confirm delete modal -->
<dialog id="modal-confirm" class="rounded-xl p-0 shadow-xl">
  <div class="p-4 w-[92vw] max-w-md">
    <p class="mb-4">Delete this product?</p>
    <div class="flex justify-end gap-2">
      <button id="confirm-no" class="rounded border px-3 py-2">No</button>
      <button id="confirm-yes" class="rounded bg-rose-600 text-white px-3 py-2">Yes, delete</button>
    </div>
  </div>
</dialog>
{% endblock %}
